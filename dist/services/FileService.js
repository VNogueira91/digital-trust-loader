"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.FileService = void 0;

class FileService {
  constructUrlBase(prefix) {
    var url;
    var location = window.location;
    var paths = location.pathname.split("/");

    while (paths.length > 0) {
      if (paths[0] === "") {
        paths.shift();
      } else {
        break;
      }
    }

    var applicationName = paths[0];
    prefix = prefix || "";
    url = "".concat(location.protocol, "//").concat(location.host, "/").concat(prefix).concat(applicationName);
    return url;
  }

  createRequest(url, method, callback) {
    var xhr = new XMLHttpRequest();
    xhr.open(method, url);

    xhr.onload = function () {
      if (xhr.status != 200) {
        callback(new Error("Error ".concat(xhr.status, ": ").concat(xhr.statusText)));
      } else {
        callback(undefined, xhr.response);
      }
    };

    xhr.onerror = function () {
      callback(new Error("Request failed"));
    };

    return xhr;
  }

  getFile(url, callback) {
    url = this.constructUrlBase() + "/" + url;
    this.createRequest(url, "GET", callback).send();
  }

  getFolderContentAsJSON(url, callback) {
    url = this.constructUrlBase("directory-summary/") + "/" + url;
    this.createRequest(url, "GET", callback).send();
  }

}

exports.FileService = FileService;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZpY2VzL0ZpbGVTZXJ2aWNlLmpzIl0sIm5hbWVzIjpbIkZpbGVTZXJ2aWNlIiwiY29uc3RydWN0VXJsQmFzZSIsInByZWZpeCIsInVybCIsImxvY2F0aW9uIiwid2luZG93IiwicGF0aHMiLCJwYXRobmFtZSIsInNwbGl0IiwibGVuZ3RoIiwic2hpZnQiLCJhcHBsaWNhdGlvbk5hbWUiLCJwcm90b2NvbCIsImhvc3QiLCJjcmVhdGVSZXF1ZXN0IiwibWV0aG9kIiwiY2FsbGJhY2siLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJvbmxvYWQiLCJzdGF0dXMiLCJFcnJvciIsInN0YXR1c1RleHQiLCJ1bmRlZmluZWQiLCJyZXNwb25zZSIsIm9uZXJyb3IiLCJnZXRGaWxlIiwic2VuZCIsImdldEZvbGRlckNvbnRlbnRBc0pTT04iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBTyxNQUFNQSxXQUFOLENBQWtCO0FBQ3JCQyxFQUFBQSxnQkFBZ0IsQ0FBQ0MsTUFBRCxFQUFTO0FBQ3JCLFFBQUlDLEdBQUo7QUFDQSxRQUFJQyxRQUFRLEdBQUdDLE1BQU0sQ0FBQ0QsUUFBdEI7QUFDQSxRQUFNRSxLQUFLLEdBQUdGLFFBQVEsQ0FBQ0csUUFBVCxDQUFrQkMsS0FBbEIsQ0FBd0IsR0FBeEIsQ0FBZDs7QUFDQSxXQUFPRixLQUFLLENBQUNHLE1BQU4sR0FBZSxDQUF0QixFQUF5QjtBQUNyQixVQUFJSCxLQUFLLENBQUMsQ0FBRCxDQUFMLEtBQWEsRUFBakIsRUFBcUI7QUFDakJBLFFBQUFBLEtBQUssQ0FBQ0ksS0FBTjtBQUNILE9BRkQsTUFHSztBQUNEO0FBQ0g7QUFDSjs7QUFDRCxRQUFJQyxlQUFlLEdBQUdMLEtBQUssQ0FBQyxDQUFELENBQTNCO0FBQ0FKLElBQUFBLE1BQU0sR0FBR0EsTUFBTSxJQUFJLEVBQW5CO0FBQ0FDLElBQUFBLEdBQUcsYUFBTUMsUUFBUSxDQUFDUSxRQUFmLGVBQTRCUixRQUFRLENBQUNTLElBQXJDLGNBQTZDWCxNQUE3QyxTQUFzRFMsZUFBdEQsQ0FBSDtBQUNBLFdBQU9SLEdBQVA7QUFDSDs7QUFDRFcsRUFBQUEsYUFBYSxDQUFDWCxHQUFELEVBQU1ZLE1BQU4sRUFBY0MsUUFBZCxFQUF3QjtBQUNqQyxRQUFJQyxHQUFHLEdBQUcsSUFBSUMsY0FBSixFQUFWO0FBQ0FELElBQUFBLEdBQUcsQ0FBQ0UsSUFBSixDQUFTSixNQUFULEVBQWlCWixHQUFqQjs7QUFDQWMsSUFBQUEsR0FBRyxDQUFDRyxNQUFKLEdBQWEsWUFBWTtBQUNyQixVQUFJSCxHQUFHLENBQUNJLE1BQUosSUFBYyxHQUFsQixFQUF1QjtBQUNuQkwsUUFBQUEsUUFBUSxDQUFDLElBQUlNLEtBQUosaUJBQW1CTCxHQUFHLENBQUNJLE1BQXZCLGVBQWtDSixHQUFHLENBQUNNLFVBQXRDLEVBQUQsQ0FBUjtBQUNILE9BRkQsTUFHSztBQUNEUCxRQUFBQSxRQUFRLENBQUNRLFNBQUQsRUFBWVAsR0FBRyxDQUFDUSxRQUFoQixDQUFSO0FBQ0g7QUFDSixLQVBEOztBQVFBUixJQUFBQSxHQUFHLENBQUNTLE9BQUosR0FBYyxZQUFZO0FBQ3RCVixNQUFBQSxRQUFRLENBQUMsSUFBSU0sS0FBSixDQUFVLGdCQUFWLENBQUQsQ0FBUjtBQUNILEtBRkQ7O0FBR0EsV0FBT0wsR0FBUDtBQUNIOztBQUNEVSxFQUFBQSxPQUFPLENBQUN4QixHQUFELEVBQU1hLFFBQU4sRUFBZ0I7QUFDbkJiLElBQUFBLEdBQUcsR0FBRyxLQUFLRixnQkFBTCxLQUEwQixHQUExQixHQUFnQ0UsR0FBdEM7QUFDQSxTQUFLVyxhQUFMLENBQW1CWCxHQUFuQixFQUF3QixLQUF4QixFQUErQmEsUUFBL0IsRUFBeUNZLElBQXpDO0FBQ0g7O0FBRURDLEVBQUFBLHNCQUFzQixDQUFDMUIsR0FBRCxFQUFNYSxRQUFOLEVBQWdCO0FBQ2xDYixJQUFBQSxHQUFHLEdBQUcsS0FBS0YsZ0JBQUwsQ0FBc0Isb0JBQXRCLElBQThDLEdBQTlDLEdBQW9ERSxHQUExRDtBQUNBLFNBQUtXLGFBQUwsQ0FBbUJYLEdBQW5CLEVBQXdCLEtBQXhCLEVBQStCYSxRQUEvQixFQUF5Q1ksSUFBekM7QUFDSDs7QUExQ29CIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIEZpbGVTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3RVcmxCYXNlKHByZWZpeCkge1xuICAgICAgICBsZXQgdXJsO1xuICAgICAgICBsZXQgbG9jYXRpb24gPSB3aW5kb3cubG9jYXRpb247XG4gICAgICAgIGNvbnN0IHBhdGhzID0gbG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoXCIvXCIpO1xuICAgICAgICB3aGlsZSAocGF0aHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaWYgKHBhdGhzWzBdID09PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgcGF0aHMuc2hpZnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGxldCBhcHBsaWNhdGlvbk5hbWUgPSBwYXRoc1swXTtcbiAgICAgICAgcHJlZml4ID0gcHJlZml4IHx8IFwiXCI7XG4gICAgICAgIHVybCA9IGAke2xvY2F0aW9uLnByb3RvY29sfS8vJHtsb2NhdGlvbi5ob3N0fS8ke3ByZWZpeH0ke2FwcGxpY2F0aW9uTmFtZX1gO1xuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH1cbiAgICBjcmVhdGVSZXF1ZXN0KHVybCwgbWV0aG9kLCBjYWxsYmFjaykge1xuICAgICAgICBsZXQgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsKTtcbiAgICAgICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzICE9IDIwMCkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcihgRXJyb3IgJHt4aHIuc3RhdHVzfTogJHt4aHIuc3RhdHVzVGV4dH1gKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayh1bmRlZmluZWQsIHhoci5yZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKFwiUmVxdWVzdCBmYWlsZWRcIikpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4geGhyO1xuICAgIH1cbiAgICBnZXRGaWxlKHVybCwgY2FsbGJhY2spIHtcbiAgICAgICAgdXJsID0gdGhpcy5jb25zdHJ1Y3RVcmxCYXNlKCkgKyBcIi9cIiArIHVybDtcbiAgICAgICAgdGhpcy5jcmVhdGVSZXF1ZXN0KHVybCwgXCJHRVRcIiwgY2FsbGJhY2spLnNlbmQoKTtcbiAgICB9XG4gICAgO1xuICAgIGdldEZvbGRlckNvbnRlbnRBc0pTT04odXJsLCBjYWxsYmFjaykge1xuICAgICAgICB1cmwgPSB0aGlzLmNvbnN0cnVjdFVybEJhc2UoXCJkaXJlY3Rvcnktc3VtbWFyeS9cIikgKyBcIi9cIiArIHVybDtcbiAgICAgICAgdGhpcy5jcmVhdGVSZXF1ZXN0KHVybCwgXCJHRVRcIiwgY2FsbGJhY2spLnNlbmQoKTtcbiAgICB9XG59Il0sImZpbGUiOiJzZXJ2aWNlcy9GaWxlU2VydmljZS5qcyJ9
